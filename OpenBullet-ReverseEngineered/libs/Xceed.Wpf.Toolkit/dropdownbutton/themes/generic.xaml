<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:chrome="clr-namespace:Xceed.Wpf.Toolkit.Chromes"
                    xmlns:conv="clr-namespace:Xceed.Wpf.Toolkit.Core.Converters"
                    xmlns:themes="clr-namespace:Xceed.Wpf.Toolkit.Themes"
                    xmlns:local="clr-namespace:Xceed.Wpf.Toolkit"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">
  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="..\..\Themes\Generic\Glyphs.xaml"/>
  </ResourceDictionary.MergedDictionaries>
  <conv:InverseBoolConverter x:Key="InverseBoolConverter"/>
  <LinearGradientBrush x:Key="PopupDarkBorderBrush" EndPoint="0.5,1" StartPoint="0.5,0">
    <GradientStop Color="#FFA3AEB9" Offset="0"/>
    <GradientStop Color="#FF8399A9" Offset="0.375"/>
    <GradientStop Color="#FF718597" Offset="0.375"/>
    <GradientStop Color="#FF617584" Offset="1"/>
  </LinearGradientBrush>
  <LinearGradientBrush x:Key="PopupBackgroundBrush" StartPoint="0,0" EndPoint="0,1">
    <GradientBrush.GradientStops>
      <GradientStopCollection>
        <GradientStop Offset="0" Color="#FFffffff"/>
        <GradientStop Offset="1" Color="#FFE8EBED"/>
      </GradientStopCollection>
    </GradientBrush.GradientStops>
  </LinearGradientBrush>
  <Style TargetType="{x:Type local:DropDownButton}">
    <Setter Property="Control.BorderThickness" Value="1"/>
    <Setter Property="Control.IsTabStop" Value="false"/>
    <Setter Property="Control.HorizontalContentAlignment" Value="Center"/>
    <Setter Property="Control.VerticalContentAlignment" Value="Center"/>
    <Setter Property="Control.Background"
            Value="{DynamicResource {x:Static themes:ResourceKeys.ButtonNormalBackgroundKey}}"/>
    <Setter Property="Control.BorderBrush"
            Value="{DynamicResource {x:Static themes:ResourceKeys.ButtonNormalOuterBorderKey}}"/>
    <Setter Property="local:DropDownButton.DropDownContentBackground"
            Value="{StaticResource PopupBackgroundBrush}"/>
    <Setter Property="Control.Padding" Value="3"/>
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type local:DropDownButton}">
          <Grid x:Name="MainGrid" SnapsToDevicePixels="true">
            <ToggleButton x:Name="PART_DropDownButton" Grid.Column="1"
                          IsChecked="{Binding IsOpen, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                          IsHitTestVisible="{Binding IsOpen, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource InverseBoolConverter}}">
              <Control.Template>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                  <ContentPresenter/>
                </ControlTemplate>
              </Control.Template>
              <Grid>
                <chrome:ButtonChrome x:Name="ToggleButtonChrome" Background="{TemplateBinding Control.Background}"
                                     Foreground="{TemplateBinding Control.Foreground}"
                                     BorderThickness="{TemplateBinding Control.BorderThickness}"
                                     BorderBrush="{TemplateBinding Control.BorderBrush}" CornerRadius="2.75"
                                     RenderChecked="{TemplateBinding local:DropDownButton.IsOpen}"
                                     RenderEnabled="{TemplateBinding UIElement.IsEnabled}"
                                     RenderMouseOver="{Binding IsMouseOver, ElementName=PART_DropDownButton}"
                                     RenderPressed="{Binding IsPressed, ElementName=PART_DropDownButton}">
                  <Grid>
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*"/>
                      <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <ContentPresenter Margin="{TemplateBinding Control.Padding}" Content="{TemplateBinding ContentControl.Content}"
                                      ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}"
                                      VerticalAlignment="{TemplateBinding Control.VerticalContentAlignment}"
                                      HorizontalAlignment="{TemplateBinding Control.HorizontalContentAlignment}"
                                      RecognizesAccessKey="true"/>
                    <Grid x:Name="arrowGlyph" IsHitTestVisible="false" Margin="4,3,4,3" Column="1">
                      <Path x:Name="Arrow" Width="9" Height="5" Data="{StaticResource DownArrowGeometry}" Fill="#FF000000"
                            Margin="0,1,0,0"/>
                    </Grid>
                  </Grid>
                </chrome:ButtonChrome>
              </Grid>
            </ToggleButton>
            <Popup x:Name="PART_Popup" HorizontalOffset="1" VerticalOffset="1" AllowsTransparency="true"
                   StaysOpen="false" Placement="{TemplateBinding local:DropDownButton.DropDownPosition}"
                   Focusable="false" ToolTip="{x:Static sys:String.Empty}"
                   IsOpen="{Binding IsChecked, ElementName=PART_DropDownButton}">
              <FrameworkElement.Resources>
                <Style TargetType="{x:Type ToolTip}">
                  <Style.Triggers>
                    <Trigger Property="ContentControl.Content" Value="{x:Static sys:String.Empty}">
                      <Setter Property="UIElement.Visibility" Value="Collapsed"/>
                    </Trigger>
                  </Style.Triggers>
                </Style>
              </FrameworkElement.Resources>
              <Border BorderThickness="1" Background="{TemplateBinding local:DropDownButton.DropDownContentBackground}"
                      BorderBrush="{StaticResource PopupDarkBorderBrush}"
                      MaxHeight="{TemplateBinding local:DropDownButton.MaxDropDownHeight}">
                <ScrollViewer x:Name="DropDownScrollViewer" VerticalScrollBarVisibility="Auto">
                  <ContentPresenter x:Name="PART_ContentPresenter" Content="{TemplateBinding local:DropDownButton.DropDownContent}"/>
                </ScrollViewer>
              </Border>
            </Popup>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="UIElement.IsEnabled" Value="false">
              <Setter TargetName="Arrow" Property="Shape.Fill" Value="#AFAFAF"/>
              <Setter Value="{DynamicResource {x:Static JetSystemColors.GrayTextBrushKey}}" Property="Control.Foreground"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
</ResourceDictionary>